[{"path":"https://mathiaslj.github.io/mcmcglm/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 mcmcglm authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/articles/customising.html","id":"adding-methods-for-new-families","dir":"Articles","previous_headings":"","what":"Adding methods for new families","title":"Customising functionalities","text":"missing piece families method calculating log-density distribution, made easily Fx. inverse gaussian distribution add method calling mcmcglm remember add additional arguments density log_likelihood_extra_args argument case fx.","code":"#' @export log_density.inverse.gaussian <- function(family, main_parameter, Y, ...) {   statmod::dinvgauss(Y, mean = main_parameter, ..., log = T) } mcmcglm <- mcmcglm(family = \"inverse.gaussian\",                    log_density_extra_args = list(shape = x, dispersion = y),                    \"other arguments\")"},{"path":[]},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"family-of-response","dir":"Articles","previous_headings":"","what":"Family of response","title":"Possibilities of package","text":"family response can family implemented family class, principle (see help(\"family\")). now, implemented families package Gaussian Binomial Poisson Negative binomial However, small amount work needed user enable use family. process expanding available families described vignette(\"customising\"). Due implementation using family object, also means compatible link function can used family, like fx. logit probit binomial family. Also, unexported check_family function package ensures accepted values family argument package‚Äôs functions character, family function family class object. different uses seen throughout examples vignette also available example section mcmcglm() documentation.","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"data-simulation-for-examples","dir":"Articles","previous_headings":"Family of response","what":"Data simulation for examples","title":"Possibilities of package","text":"order show package provides samples target posterior distribution, simulate data scenario known Œ≤\\beta vector order see empirical distribution coefficient seems match value simulated data . start generating linear predictor Œ∑=XŒ≤\\eta=X\\beta known values Œ≤\\beta sampled values making design matrix XX. , example can apply relevant inverse link function g‚àí1g^{-1} obtain modelled mean Œº=g‚àí1(XŒ≤)\\mu=g^{-1}(X\\beta) GLM model. can simulate response sampling distribution corresponding family using modelled mean Œº\\mu relevant parameter distribution. example gaussian family available introductory example README.","code":"n <- 1000 x1 <- rnorm (n) x2 <- rbinom (n, 1, .5) b0 <- 1 b1 <- 1.5 b2 <- 2 lin_pred <- b0+b1*x1+b2*x2"},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"example-for-binomial-family","dir":"Articles","previous_headings":"Family of response","what":"Example for binomial family","title":"Possibilities of package","text":"binomial family, commonly used link function logit given logit(p)=lnp1‚àíp\\begin{align} logit(p)=\\ln\\frac{p}{1-p} \\end{align} link functions also available, including probit, cauchit, log cloglog (see help(family) information). ‚Äôll show example first binomial family logit link function.","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"logit-link-function","dir":"Articles","previous_headings":"Family of response > Example for binomial family","what":"Logit link function","title":"Possibilities of package","text":"First, define data fit mcmcglm inspect trace plot.","code":"logit_binom <- binomial(link = \"logit\")  mu_probit <- logit_binom$linkinv(lin_pred) y_probit <- rbinom(n, size = 1, prob = mu_probit) dat_probit <- data.frame(Y = y_probit, X1 = x1, X2 = x2) probit <- mcmcglm(formula = Y ~ .,                  data = dat_probit,                  family = binomial(link = \"probit\"),                  beta_prior = distributional::dist_normal(mean = 0, sd = 1),                  w = 0.5) probit #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = binomial(link = \"probit\"),  #>     data = dat_probit, beta_prior = distributional::dist_normal(mean = 0,  #>         sd = 1), w = 0.5) #>  #> Average of parameter samples: #>   (Intercept)        X1       X2 #> 1   0.5627384 0.8385937 1.178336 trace_plot(probit)"},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"probit-link-function","dir":"Articles","previous_headings":"Family of response > Example for binomial family","what":"Probit link function","title":"Possibilities of package","text":"First, define data fit mcmcglm inspect trace plot.","code":"probit_binom <- binomial(link = \"probit\")  mu_probit <- probit_binom$linkinv(lin_pred) y_probit <- rbinom(n, size = 1, prob = mu_probit) dat_probit <- data.frame(Y = y_probit, X1 = x1, X2 = x2) probit <- mcmcglm(formula = Y ~ .,                  data = dat_probit,                  family = binomial(link = \"probit\"),                  beta_prior = distributional::dist_normal(mean = 0, sd = 1),                  w = 0.5) probit #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = binomial(link = \"probit\"),  #>     data = dat_probit, beta_prior = distributional::dist_normal(mean = 0,  #>         sd = 1), w = 0.5) #>  #> Average of parameter samples: #>   (Intercept)      X1       X2 #> 1   0.9740665 1.50066 1.917127 trace_plot(probit)"},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"example-for-poisson-family","dir":"Articles","previous_headings":"Family of response","what":"Example for poisson family","title":"Possibilities of package","text":"poisson family, commonly used link function log, one showcase example binomial family shows ‚Äôs easily possible specify link function. Define data fit mcmcglm inspect trace plot.","code":"mu_log <- exp(lin_pred) y_pois <- rpois(n, lambda = mu_log) dat_pois <- data.frame(Y = y_pois, X1 = x1, X2 = x2) pois <- mcmcglm(formula = Y ~ .,                  data = dat_pois,                  family = \"poisson\",                  beta_prior = distributional::dist_normal(mean = 0, sd = 1),                  w = 0.5) pois #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = \"poisson\", data = dat_pois,  #>     beta_prior = distributional::dist_normal(mean = 0, sd = 1),  #>     w = 0.5) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1   0.6204822 1.491828 2.396303 trace_plot(pois)"},{"path":"https://mathiaslj.github.io/mcmcglm/articles/pospkg.html","id":"example-for-negative-binomial-family","dir":"Articles","previous_headings":"Family of response","what":"Example for negative binomial family","title":"Possibilities of package","text":"Besides families available stats package (via help(\"family\")), families implemented various packages. Fx. MASS::negative.binomial() function allows use negative binomial family various inference procedures. distribution interesting choice modelling count data Poisson distribution appropriate due equality first second moment distribution. showcase use family using package. fit mcmcglm inspect trace plot.","code":"mu_log <- exp(lin_pred) y_nbinom <- rnbinom(n, size = 1, mu = mu_log) dat_nbinom <- data.frame(Y = y_nbinom, X1 = x1, X2 = x2)  theta <- 3 nbinom <- mcmcglm(formula = Y ~ .,                  data = dat_nbinom,                  family = MASS::negative.binomial(theta),                  beta_prior = distributional::dist_normal(mean = 0, sd = 1),                  w = 0.5) nbinom #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(theta),  #>     data = dat_nbinom, beta_prior = distributional::dist_normal(mean = 0,  #>         sd = 1), w = 0.5) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1   0.9266945 1.488598 2.072239 trace_plot(nbinom)"},{"path":[]},{"path":[]},{"path":"https://mathiaslj.github.io/mcmcglm/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mathias Lerbech Jeppesen. Author, maintainer.","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jeppesen M (2024). mcmcglm: Gibbs Sampling Methods. R package version 0.0.0.9000, https://mathiaslj.github.io/mcmcglm/, https://github.com/mathiaslj/mcmcglm.","code":"@Manual{,   title = {mcmcglm: Gibbs Sampling Methods},   author = {Mathias Lerbech Jeppesen},   year = {2024},   note = {R package version 0.0.0.9000, https://mathiaslj.github.io/mcmcglm/},   url = {https://github.com/mathiaslj/mcmcglm}, }"},{"path":"https://mathiaslj.github.io/mcmcglm/index.html","id":"mcmcglm","dir":"","previous_headings":"","what":"Gibbs Sampling Methods","title":"Gibbs Sampling Methods","text":"mcmcglm package implements CGGibbs sampler article Gibbs sampling faster Hamiltonian Monte Carlo GLMs?, linear run time function number parameters GLM model due clever ‚Äúupdate‚Äù linear predictor. package implemented way user can specify family response distribution prior Œ≤\\beta parameter, ùîº[Y|XŒ≤]=g‚àí1(XŒ≤)\\mathbb{E}[Y|X\\beta]=g^{-1}(X\\beta) link function gg specified family. See vignette(\"pospkg\").","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Gibbs Sampling Methods","text":"Installation available GitHub :","code":"devtools::install_github(\"mathiaslj/mcmcglm\") library(mcmcglm, warn.conflicts = FALSE)"},{"path":"https://mathiaslj.github.io/mcmcglm/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Gibbs Sampling Methods","text":"first simulate data linear model use showcasing use mcmcglm gaussian family. use function mcmcglm similar interface glm function added mandatory specification prior parameter Œ≤\\beta default qslice::slice_stepping_out function, performs slice sampling described Neal 2003 slice width w needs specified. creates mcmcglm object prints summarising call function averages samples parameter GLM model.","code":"n <- 100 x1 <- rnorm (n) x2 <- rbinom (n, 1, .5) b0 <- 1 b1 <- 1.5 b2 <- 2 lin_pred <- b0+b1*x1+b2*x2  y_norm <- rnorm(n, mean = lin_pred, sd = 1) dat_norm <- data.frame(Y = y_norm, X1 = x1, X2 = x2) norm <- mcmcglm(formula = Y ~ .,                 family = \"gaussian\",                 data = dat_norm,                 beta_prior = distributional::dist_normal(0, 1),                 w = 0.5) norm #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = \"gaussian\", data = dat_norm,  #>     beta_prior = distributional::dist_normal(0, 1), w = 0.5) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1    1.308767 1.588089 1.911371"},{"path":"https://mathiaslj.github.io/mcmcglm/index.html","id":"investigating-results","dir":"","previous_headings":"Example","what":"Investigating results","title":"Gibbs Sampling Methods","text":"full data set samples can accessed samples function: trace plot can seen function trace_plot:","code":"head(samples(norm)) #>   (Intercept)        X1         X2 iteration burnin #> 1   -1.175349 0.3342448 -0.4236988         0   TRUE #> 2    3.800078 1.9470571 -0.3653884         1   TRUE #> 3    1.781214 1.2777100  0.5939912         2   TRUE #> 4    2.057276 1.3513283  1.2464906         3   TRUE #> 5    1.917690 1.3670896  1.3285935         4   TRUE #> 6    1.891912 1.5566877  0.9924681         5   TRUE trace_plot(norm)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_density.html","id":null,"dir":"Reference","previous_headings":"","what":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","title":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","text":"methods parametrised \"mu\" takes additional arguments needed calculation ... argument","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","text":"","code":"log_density(family, mu, Y, ...)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","text":"family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) mu numeric vector values \"main\" parameter distribution specified family argument Y numeric vector response variable evaluate density ... arguments passed relevant methods","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","text":"numeric vector log_density values","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_density.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"S3 generic for calculating the log density of a distribution dispatched via a family ‚Äî log_density","text":"Supported families gaussian, binomial, poisson negative.binomial. Implement S3 method add support new family. mcmcglm function called, mu modelled mean glm model (meaning inverse link linear predictor). Reference methods see parametrisation","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate log likelihood parametrised by ","title":"Calculate log likelihood parametrised by ","text":"Calculate log likelihood parametrised \"mu\"","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate log likelihood parametrised by ","text":"","code":"log_likelihood(family, mu, Y, ...)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate log likelihood parametrised by ","text":"family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) mu numeric vector values \"main\" parameter distribution specified family argument Y numeric vector response variable evaluate density ... arguments passed S3 generic log_density","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate log likelihood parametrised by ","text":"numeric Value log-likelihood","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate log likelihood parametrised by ","text":"See log_density details","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_likelihood.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate log likelihood parametrised by ","text":"","code":"# Create a test data n <- 100 x1 <- rnorm (n) x2 <- rbinom (n, 1, .5) b0 <- 1 b1 <- 1.5 b2 <- 2 lin_pred <- b0+b1*x1+b2*x2 known_sigma <- 1  y_norm <- rnorm(n, mean = lin_pred, sd = known_sigma) model_matrix_norm <- as.matrix(    data.frame(int = 1, X1 = x1, X2 = x2))  b_prior <- 1:3  mu <- model_matrix_norm %*% b_prior  log_likelihood(family = gaussian,                mu = mu,                Y = y_norm,                sd = known_sigma) #> [1] -178.4539"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_potential_from_betaj.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","title":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","text":"Calculates log-potential function new coordinate beta parameter vector. Done like use unexporte","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_potential_from_betaj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","text":"","code":"log_potential_from_betaj(   new_beta_j,   j,   current_beta,   current_eta,   Y,   X_j,   family,   beta_prior,   ... )"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_potential_from_betaj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","text":"new_beta_j numeric new value j'th component beta parameter vector j numeric index parameter vector current_beta current value beta parameter vector sampling procedure current_eta current value linear predictor corresponding current_beta value Y numeric vector response variable evaluate density X_j j'th column design matrix family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) beta_prior distribution object created function distributional package. fx. distributional::dist_normal(mean = 0, sd = 1). ... arguments passed S3 generic log_density","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_potential_from_betaj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","text":"value log-potential changed j'th component current_beta new_beta_j","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/log_potential_from_betaj.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the log-potential (log-likelihood plus log-density of prior) ‚Äî log_potential_from_betaj","text":"","code":"# Create a test data n <- 100 x1 <- rnorm (n) x2 <- rbinom (n, 1, .5) b0 <- 1 b1 <- 1.5 b2 <- 2 lin_pred <- b0+b1*x1+b2*x2 known_sigma <- 1  y_norm <- rnorm(n, mean = lin_pred, sd = known_sigma) model_matrix_norm <- as.matrix(    data.frame(int = 1, X1 = x1, X2 = x2)) b_prior <- distributional::dist_normal(mean = 0, sd = 1) b_prior_init <- distributional::generate(     b_prior,     ncol(model_matrix_norm) )[[1]]  eta_init <- model_matrix_norm %*% b_prior_init  j <- 1 new_beta_j <- 4  log_potential_from_betaj(new_beta_j = new_beta_j,                          j = j, current_beta = b_prior_init,                          current_eta = eta_init,                          Y = y_norm,                          X_j = model_matrix_norm[, j],                          family = gaussian,                          beta_prior = b_prior,                          sd = known_sigma) #> [1] -497.1328"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mcmcglm: Gibbs Sampling Methods ‚Äî mcmcglm-package","title":"mcmcglm: Gibbs Sampling Methods ‚Äî mcmcglm-package","text":"Sample posterior distributions using variations slice within Gibbs samplers GLMs.","code":""},{"path":[]},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mcmcglm: Gibbs Sampling Methods ‚Äî mcmcglm-package","text":"Maintainer: Mathias Lerbech Jeppesen mathiasljeppesen@outlook.com","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":null,"dir":"Reference","previous_headings":"","what":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"Obtain MCMC samples using slice sampling within Gibbs generalized linear models (GLMs) using compute graph Gibbs (CGGibbs) linear runtime number variables model matrix. Method described article Gibbs sampling faster Hamiltonian Monte Carlo GLMs?, see details .","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"","code":"mcmcglm(   formula,   family = gaussian,   data,   beta_prior = distributional::dist_normal(0, 1),   log_likelihood_extra_args = list(sd = 1),   sample_method = c(\"slice_sampling\", \"normal-normal\"),   qslice_fun = qslice::slice_stepping_out,   ...,   n_samples = 100,   burnin = 10 )"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"formula object class \"formula\" (one can coerced class): symbolic description model fitted. See details stats::glm family description error distribution link function used model. can character string naming family function, family function result call family function. (See family details family functions.) data optional data frame, list environment (object coercible .data.frame data frame) containing variables model. found data, variables taken environment(formula), typically environment function called. beta_prior distribution object created function distributional package. fx. distributional::dist_normal(mean = 0, sd = 1). log_likelihood_extra_args named list arguments passed onto log_density function. Fx. specification log_likelihood_extra_args = list(sd = x) needed case family = \"gaussian\" sample_method character specifying method used sampling. default \"slice_sampling\" intended value cases, works specification family beta_prior. \"normal-normal\" uses conditional normal distribution sample case conjugate prior gaussian response beta_prior. Implemented testing purposes works niche case. qslice_fun function qslice package. Default qslice::slice_stepping_out uses slice sampler Neal 2003, functions available. ... arguments passed onto function specified qslice_fun. default qslice::slice_stepping_out w needs specified, fx. qslice::slice_elliptical, mu sigma need specified n_samples numeric number samples draw parameter(/variable) model burnin numeric number samples marked \"burnin\". Burnin samples included beta_mean calculation increase finite sample performance LLN estimate","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"object class mcmcglm methods getting data.frame parameter samples, plotting, etc.","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"uses updating scheme linear predictor draw Gibbs sampling coordinates parameter vector","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"Gibbs sampling faster Hamiltonian Monte Carlo GLMs?, Neal 2003","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/mcmcglm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Efficient Gibbs sampling of posterior distribution of parameters in GLM ‚Äî mcmcglm","text":"","code":"# Create test data for different scenarios n <- 100 x1 <- rnorm (n) x2 <- rbinom (n, 1, .5) b0 <- 1 b1 <- 1.5 b2 <- 2 lin_pred <- b0+b1*x1+b2*x2  ############################################# # Different families and priors  # For family \"gaussian\" and iid normal prior y_norm <- rnorm(n, mean = lin_pred, sd = 1) dat_norm <- data.frame(Y = y_norm, X1 = x1, X2 = x2)  norm <- mcmcglm(formula = Y ~ .,                    data = dat_norm,                    beta_prior = distributional::dist_normal(0, 1),                    family = \"gaussian\",                    n_samples = 100,                    burnin = 10,                    sample_method = \"slice_sampling\",                    qslice_fun = qslice::slice_stepping_out,                    w = 0.5) norm #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = \"gaussian\", data = dat_norm,  #>     beta_prior = distributional::dist_normal(0, 1), sample_method = \"slice_sampling\",  #>     qslice_fun = qslice::slice_stepping_out, w = 0.5, n_samples = 100,  #>     burnin = 10) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1    1.076355 1.755597 1.647004 #>   # For family \"binomial\" with logit link and iid gamma distributed prior y_logit <- rbinom (n, 1, arm::invlogit(lin_pred)) dat_logit <- data.frame(Y = y_logit, X1 = x1, X2 = x2)  logit <- mcmcglm(formula = Y ~ .,                    data = dat_logit,                    beta_prior = distributional::dist_gamma(shape = 1, rate = 0.5),                    family = binomial(link = \"logit\"),                    n_samples = 100,                    burnin = 10,                    sample_method = \"slice_sampling\",                    qslice_fun = qslice::slice_stepping_out,                    w = 0.8) logit #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = binomial(link = \"logit\"), data = dat_logit,  #>     beta_prior = distributional::dist_gamma(shape = 1, rate = 0.5),  #>     sample_method = \"slice_sampling\", qslice_fun = qslice::slice_stepping_out,  #>     w = 0.8, n_samples = 100, burnin = 10) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1   0.9290604 1.650482 2.612257 #>   # For family \"negative.binomial\" and multivariate normal specification of parameter priors  y_log <- rnbinom(n, size = 1, mu = exp(lin_pred)) dat_log <- data.frame(Y = y_log, X1 = x1, X2 = x2)  log <- mcmcglm(formula = Y ~ X1,                    data = dat_log,                    beta_prior = distributional::dist_multivariate_normal(                       mu = list(c(1, 2)),                       sigma = list(matrix(c(1, 0.5, 0.5, 1), ncol = 2))                    ),                    family = MASS::negative.binomial(3),                    n_samples = 100,                    burnin = 10,                    sample_method = \"slice_sampling\",                    qslice_fun = qslice::slice_stepping_out,                    w = 0.8) log #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ X1, family = MASS::negative.binomial(3),  #>     data = dat_log, beta_prior = distributional::dist_multivariate_normal(mu = list(c(1,  #>         2)), sigma = list(matrix(c(1, 0.5, 0.5, 1), ncol = 2))),  #>     sample_method = \"slice_sampling\", qslice_fun = qslice::slice_stepping_out,  #>     w = 0.8, n_samples = 100, burnin = 10) #>  #> Average of parameter samples: #>   (Intercept)       X1 iteration #> 1    2.378161 1.536763        56 #>   # For family \"negative.binomial\" and specification of different independent # priors for each parameter log2 <- mcmcglm(formula = Y ~ .,                    data = dat_log,                    beta_prior = list(distributional::dist_normal(0, 1),                                      distributional::dist_gamma(1, 1),                                      distributional::dist_exponential(2)),                    family = MASS::negative.binomial(3),                    n_samples = 100,                    burnin = 10,                    sample_method = \"slice_sampling\",                    qslice_fun = qslice::slice_stepping_out,                    w = 0.8) log2 #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(3),  #>     data = dat_log, beta_prior = list(distributional::dist_normal(0,  #>         1), distributional::dist_gamma(1, 1), distributional::dist_exponential(2)),  #>     sample_method = \"slice_sampling\", qslice_fun = qslice::slice_stepping_out,  #>     w = 0.8, n_samples = 100, burnin = 10) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1   0.8302263 1.408839 2.186192 #>   ############################################# # Using a different slice function log3 <- mcmcglm(formula = Y ~ .,                    data = dat_log,                    beta_prior = list(distributional::dist_normal(0, 1),                                      distributional::dist_gamma(1, 1),                                      distributional::dist_exponential(2)),                    family = MASS::negative.binomial(3),                    n_samples = 100,                    burnin = 10,                    sample_method = \"slice_sampling\",                    qslice_fun = qslice::slice_elliptical,                    mu = 1.5,                    sigma = 2) log3 #> Object of class 'mcmcglm' #>  #> Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(3),  #>     data = dat_log, beta_prior = list(distributional::dist_normal(0,  #>         1), distributional::dist_gamma(1, 1), distributional::dist_exponential(2)),  #>     sample_method = \"slice_sampling\", qslice_fun = qslice::slice_elliptical,  #>     mu = 1.5, sigma = 2, n_samples = 100, burnin = 10) #>  #> Average of parameter samples: #>   (Intercept)       X1       X2 #> 1   0.8371451 1.407306 2.161397 #>"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the drawn samples from the object ‚Äî samples","title":"Get the drawn samples from the object ‚Äî samples","text":"Get drawn samples object","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the drawn samples from the object ‚Äî samples","text":"","code":"samples(x)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the drawn samples from the object ‚Äî samples","text":"x mcmcglm object","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/trace_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a trace plot of the MCMC samples ‚Äî trace_plot","title":"Create a trace plot of the MCMC samples ‚Äî trace_plot","text":"Create trace plot MCMC samples","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/trace_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a trace plot of the MCMC samples ‚Äî trace_plot","text":"","code":"trace_plot(x, samples_drop = NULL)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/trace_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a trace plot of the MCMC samples ‚Äî trace_plot","text":"x mcmcglm object samples_drop numeric specifying number initial samples exclude trace_plot improve axis zoom plot","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/update_linear_predictor.html","id":null,"dir":"Reference","previous_headings":"","what":"Update value of a linear predictor as function of a single coordinate change ‚Äî update_linear_predictor","title":"Update value of a linear predictor as function of a single coordinate change ‚Äî update_linear_predictor","text":"Function updating linear predictor n actions rather nn_vars actions naively matrix-vector product X %% beta","code":""},{"path":"https://mathiaslj.github.io/mcmcglm/reference/update_linear_predictor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update value of a linear predictor as function of a single coordinate change ‚Äî update_linear_predictor","text":"","code":"update_linear_predictor(new_beta_j, current_beta_j, current_eta, X_j)"},{"path":"https://mathiaslj.github.io/mcmcglm/reference/update_linear_predictor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update value of a linear predictor as function of a single coordinate change ‚Äî update_linear_predictor","text":"new_beta_j numeric new value j'th component beta parameter vector current_beta_j numeric current value j'th component beta parameter vector current_eta current value linear predictor corresponding current_beta value X_j j'th column design matrix","code":""}]
