<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Efficient Gibbs sampling of posterior distribution of parameters in GLM — mcmcglm • mcmcglm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Efficient Gibbs sampling of posterior distribution of parameters in GLM — mcmcglm"><meta name="description" content="Obtain MCMC samples using slice sampling within Gibbs for generalized linear models (GLMs) using
compute graph Gibbs (CGGibbs) which has linear runtime in the number of variables in the model
matrix. Method is described in the article
Is Gibbs sampling faster than Hamiltonian Monte Carlo on GLMs?,
and see more in details below."><meta property="og:description" content="Obtain MCMC samples using slice sampling within Gibbs for generalized linear models (GLMs) using
compute graph Gibbs (CGGibbs) which has linear runtime in the number of variables in the model
matrix. Method is described in the article
Is Gibbs sampling faster than Hamiltonian Monte Carlo on GLMs?,
and see more in details below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcmcglm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pospkg.html">Examples of family, prior and slice sampler specifications</a></li>
    <li><a class="dropdown-item" href="../articles/customising.html">Adding methods for families</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mathiaslj/mcmcglm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Efficient Gibbs sampling of posterior distribution of parameters in GLM</h1>
      <small class="dont-index">Source: <a href="https://github.com/mathiaslj/mcmcglm/blob/main/R/mcmcglm.R" class="external-link"><code>R/mcmcglm.R</code></a></small>
      <div class="d-none name"><code>mcmcglm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Obtain MCMC samples using slice sampling within Gibbs for generalized linear models (GLMs) using
compute graph Gibbs (CGGibbs) which has linear runtime in the number of variables in the model
matrix. Method is described in the article
<a href="https://arxiv.org/abs/2410.03630" class="external-link">Is Gibbs sampling faster than Hamiltonian Monte Carlo on GLMs?</a>,
and see more in details below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcmcglm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  log_likelihood_extra_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sample_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"slice_sampling"</span>, <span class="st">"normal-normal"</span><span class="op">)</span>,</span>
<span>  qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">slice_stepping_out</a></span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an object of class "<a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a>" (or one that can be coerced to that class): a symbolic
description of the model to be fitted. See more details at <a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm</a></p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link function to be used in the model.
This can be a <code>character</code> string naming a family function, a family function or the result
of a call to a family function. (See <a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a> for details of family functions.)</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional <code>data frame</code>, <code>list</code> or <code>environment</code> (or object coercible by <a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a> to a
data frame) containing the variables in the model. If not found in data, the variables are taken
from <code>environment(formula)</code>, typically the environment from which the function is called.</p></dd>


<dt id="arg-beta-prior">beta_prior<a class="anchor" aria-label="anchor" href="#arg-beta-prior"></a></dt>
<dd><p>a <code>distribution</code> object created by a function from the
<code>distributional</code> package. Could fx. be <code>distributional::dist_normal(mean = 0, sd = 1)</code>.</p></dd>


<dt id="arg-log-likelihood-extra-args">log_likelihood_extra_args<a class="anchor" aria-label="anchor" href="#arg-log-likelihood-extra-args"></a></dt>
<dd><p>a named <code>list</code> with arguments passed onto the <a href="log_density.html">log_density</a> function.
Fx. specification of <code>log_likelihood_extra_args = list(sd = x)</code> is needed for the case of
<code>family = "gaussian"</code></p></dd>


<dt id="arg-sample-method">sample_method<a class="anchor" aria-label="anchor" href="#arg-sample-method"></a></dt>
<dd><p>a <code>character</code> specifying the method used for sampling. The default <code>"slice_sampling"</code>
is the intended value in most cases, as it works for any specification of <code>family</code> and <code>beta_prior</code>.
<code>"normal-normal"</code> uses a conditional normal distribution to sample from in case of conjugate prior with
gaussian response and <code>beta_prior</code>. Implemented for testing purposes but works for that niche case.</p></dd>


<dt id="arg-qslice-fun">qslice_fun<a class="anchor" aria-label="anchor" href="#arg-qslice-fun"></a></dt>
<dd><p>a <code>function</code> from the
<a href="https://CRAN.R-project.org/package=qslice" class="external-link">qslice</a> package.
Default is <a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">qslice::slice_stepping_out</a> which uses the slice sampler from
<a href="https://projecteuclid.org/journals/annals-of-statistics/volume-31/issue-3/Slice-sampling/10.1214/aos/1056562461.full" class="external-link">Neal 2003</a>,
but all functions are available.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed onto the function specified by <code>qslice_fun</code>. For default <a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">qslice::slice_stepping_out</a>
<code>w</code> needs to be specified, while for fx. <a href="https://rdrr.io/pkg/qslice/man/slice_elliptical.html" class="external-link">qslice::slice_elliptical</a>, <code>mu</code> and <code>sigma</code> need to be specified</p></dd>


<dt id="arg-n-samples">n_samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>a <code>numeric</code> with number of samples to draw of each parameter(/variable) in the model</p></dd>


<dt id="arg-burnin">burnin<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>a <code>numeric</code> with the number of samples to be marked as "burnin". Burnin samples are not
included in the <code>beta_mean</code> calculation to increase finite sample performance of the LLN estimate</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>mcmcglm</code> with methods for getting a <code>data.frame</code> of parameter samples, plotting, etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>uses an updating scheme for the linear predictor during each
draw of Gibbs sampling on coordinates of the parameter vector</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://arxiv.org/abs/2410.03630" class="external-link">Is Gibbs sampling faster than Hamiltonian Monte Carlo on GLMs?</a>,
<a href="https://projecteuclid.org/journals/annals-of-statistics/volume-31/issue-3/Slice-sampling/10.1214/aos/1056562461.full" class="external-link">Neal 2003</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create test data for different scenarios</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span> <span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span> <span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">lin_pred</span> <span class="op">&lt;-</span> <span class="va">b0</span><span class="op">+</span><span class="va">b1</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="va">b2</span><span class="op">*</span><span class="va">x2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################</span></span></span>
<span class="r-in"><span><span class="co"># Different families and priors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For family "gaussian" and iid normal prior</span></span></span>
<span class="r-in"><span><span class="va">y_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">lin_pred</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_norm</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">norm</span> <span class="op">&lt;-</span> <span class="fu">mcmcglm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">dat_norm</span>,</span></span>
<span class="r-in"><span>                   beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>                   n_samples <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                   burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   sample_method <span class="op">=</span> <span class="st">"slice_sampling"</span>,</span></span>
<span class="r-in"><span>                   qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">slice_stepping_out</a></span>,</span></span>
<span class="r-in"><span>                   w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">norm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class 'mcmcglm'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  mcmcglm(formula = Y ~ ., family = "gaussian", data = dat_norm, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     beta_prior = distributional::dist_normal(0, 1), sample_method = "slice_sampling", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     qslice_fun = qslice::slice_stepping_out, w = 0.5, n_samples = 100, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     burnin = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average of parameter samples:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)       X1       X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1.076355 1.755597 1.647004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For family "binomial" with logit link and iid gamma distributed prior</span></span></span>
<span class="r-in"><span><span class="va">y_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span> <span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/invlogit.html" class="external-link">invlogit</a></span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_logit</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">logit</span> <span class="op">&lt;-</span> <span class="fu">mcmcglm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">dat_logit</span>,</span></span>
<span class="r-in"><span>                   beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_gamma.html" class="external-link">dist_gamma</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n_samples <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                   burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   sample_method <span class="op">=</span> <span class="st">"slice_sampling"</span>,</span></span>
<span class="r-in"><span>                   qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">slice_stepping_out</a></span>,</span></span>
<span class="r-in"><span>                   w <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">logit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class 'mcmcglm'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  mcmcglm(formula = Y ~ ., family = binomial(link = "logit"), data = dat_logit, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     beta_prior = distributional::dist_gamma(shape = 1, rate = 0.5), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sample_method = "slice_sampling", qslice_fun = qslice::slice_stepping_out, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     w = 0.8, n_samples = 100, burnin = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average of parameter samples:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)       X1       X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.9290604 1.650482 2.612257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For family "negative.binomial" and multivariate normal specification of parameter priors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_log</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">log</span> <span class="op">&lt;-</span> <span class="fu">mcmcglm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">dat_log</span>,</span></span>
<span class="r-in"><span>                   beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_multivariate_normal.html" class="external-link">dist_multivariate_normal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                      mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   <span class="op">)</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">negative.binomial</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n_samples <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                   burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   sample_method <span class="op">=</span> <span class="st">"slice_sampling"</span>,</span></span>
<span class="r-in"><span>                   qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">slice_stepping_out</a></span>,</span></span>
<span class="r-in"><span>                   w <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class 'mcmcglm'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  mcmcglm(formula = Y ~ X1, family = MASS::negative.binomial(3), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat_log, beta_prior = distributional::dist_multivariate_normal(mu = list(c(1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         2)), sigma = list(matrix(c(1, 0.5, 0.5, 1), ncol = 2))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sample_method = "slice_sampling", qslice_fun = qslice::slice_stepping_out, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     w = 0.8, n_samples = 100, burnin = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average of parameter samples:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)       X1 iteration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2.378161 1.536763        56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For family "negative.binomial" and specification of different independent</span></span></span>
<span class="r-in"><span><span class="co"># priors for each parameter</span></span></span>
<span class="r-in"><span><span class="va">log2</span> <span class="op">&lt;-</span> <span class="fu">mcmcglm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">dat_log</span>,</span></span>
<span class="r-in"><span>                   beta_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_gamma.html" class="external-link">dist_gamma</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_exponential.html" class="external-link">dist_exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">negative.binomial</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n_samples <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                   burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   sample_method <span class="op">=</span> <span class="st">"slice_sampling"</span>,</span></span>
<span class="r-in"><span>                   qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">slice_stepping_out</a></span>,</span></span>
<span class="r-in"><span>                   w <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class 'mcmcglm'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(3), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat_log, beta_prior = list(distributional::dist_normal(0, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1), distributional::dist_gamma(1, 1), distributional::dist_exponential(2)), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sample_method = "slice_sampling", qslice_fun = qslice::slice_stepping_out, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     w = 0.8, n_samples = 100, burnin = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average of parameter samples:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)       X1       X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.8302263 1.408839 2.186192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################</span></span></span>
<span class="r-in"><span><span class="co"># Using a different slice function</span></span></span>
<span class="r-in"><span><span class="va">log3</span> <span class="op">&lt;-</span> <span class="fu">mcmcglm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">dat_log</span>,</span></span>
<span class="r-in"><span>                   beta_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_gamma.html" class="external-link">dist_gamma</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_exponential.html" class="external-link">dist_exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">negative.binomial</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n_samples <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                   burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                   sample_method <span class="op">=</span> <span class="st">"slice_sampling"</span>,</span></span>
<span class="r-in"><span>                   qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_elliptical.html" class="external-link">slice_elliptical</a></span>,</span></span>
<span class="r-in"><span>                   mu <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>                   sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class 'mcmcglm'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(3), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat_log, beta_prior = list(distributional::dist_normal(0, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1), distributional::dist_gamma(1, 1), distributional::dist_exponential(2)), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sample_method = "slice_sampling", qslice_fun = qslice::slice_elliptical, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mu = 1.5, sigma = 2, n_samples = 100, burnin = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average of parameter samples:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Intercept)       X1       X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.8371451 1.407306 2.161397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mathias Lerbech Jeppesen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

