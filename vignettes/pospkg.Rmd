---
title: "Possibilities of package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Possibilities of package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  
```{r, include = FALSE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width = 7
)
```

```{r setup}
library(mcmcglm)
```

## Family of response

The family of the response can be any family with an implemented `family` class, in principle. As of now, the implemented families in the package are

- Gaussian
- Binomial
- Poisson
- Negative binomial

However, only a small amount of work is needed from the user to enable the use of any family. The process of expanding available families is described in `vignette("customising")`.

Due to the implementation using a `family` object, This also means that any compatible link function can be used for a family, like fx. logit or probit for the binomial family.

An example for the gaussian family is available in the introductory example in the [README](https://mathiaslj.github.io/mcmcglm/index.html).

We start by generating a linear predictor $\eta=X\beta$ from known values of $\beta$ and sampled values making up the design matrix $X$. Then, in each example we can apply the relevant inverse link function $g^{-1}$ to obtain the modelled mean $\mu=g^{-1}(X\beta)$ in the GLM model. We can the simulate our response as sampling from the distribution corresponding to the family using the modelled mean $\mu$ as the relevant parameter of the distribution.

```{r, label = linear-predictor}
n <- 1000
x1 <- rnorm (n)
x2 <- rbinom (n, 1, .5)
b0 <- 1
b1 <- 1.5
b2 <- 2
lin_pred <- b0+b1*x1+b2*x2
```

### Example for binomial family

For the binomial family, the most commonly used link function is the logit given by
\begin{align}
logit(p)=\ln\frac{p}{1-p}
\end{align}

but other link functions are also available, including probit, cauchit, log and cloglog (see `help(family)` for more information).

We'll show an example first for the binomial family with logit link function.

#### Logit link function

First, we define the data
```{r, label = logit-data}
logit_binom <- binomial(link = "logit")

mu_logit <- logit_binom$linkinv(lin_pred)
y_logit <- rbinom(n, size = 1, prob = mu_logit)
dat_logit <- data.frame(Y = y_logit, X1 = x1, X2 = x2)
```

Then we fit the `mcmcglm` and inspect the trace plot.
```{r, label = logit-run-show}
logit <- mcmcglm(formula = Y ~ .,
                 data = dat_logit,
                 family = binomial(link = "logit"),
                 beta_prior = distributional::dist_normal(mean = 0, sd = 1),
                 w = 0.5)
logit
trace_plot(logit)
```

#### Probit link function

First, we define the data
```{r, label = probit-data}
probit_binom <- binomial(link = "probit")

mu_probit <- probit_binom$linkinv(lin_pred)
y_probit <- rbinom(n, size = 1, prob = mu_probit)
dat_probit <- data.frame(Y = y_probit, X1 = x1, X2 = x2)
```

Then we fit the `mcmcglm` and inspect the trace plot.
```{r, label = probit-run-show}
probit <- mcmcglm(formula = Y ~ .,
                 data = dat_probit,
                 family = binomial(link = "probit"),
                 beta_prior = distributional::dist_normal(mean = 0, sd = 1),
                 w = 0.5)
probit
trace_plot(probit)
```

### Example for poisson family
