<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples of family, prior and slice sampler specifications • mcmcglm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples of family, prior and slice sampler specifications">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcmcglm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pospkg.html">Examples of family, prior and slice sampler specifications</a></li>
    <li><a class="dropdown-item" href="../articles/customising.html">Adding methods for families</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mathiaslj/mcmcglm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Examples of family, prior and slice sampler specifications</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mathiaslj/mcmcglm/blob/main/vignettes/pospkg.Rmd" class="external-link"><code>vignettes/pospkg.Rmd</code></a></small>
      <div class="d-none name"><code>pospkg.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="family-of-response">Family of response<a class="anchor" aria-label="anchor" href="#family-of-response"></a>
</h2>
<p>The family of the response can be any family with an implemented
<code>family</code> class, in principle (see
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">help("family")</a></code>). As of now, the implemented families in the
package are</p>
<ul>
<li>Gaussian</li>
<li>Binomial</li>
<li>Poisson</li>
<li>Negative binomial</li>
</ul>
<p>However, only a small amount of work is needed from the user to
enable the use of any family. The process of expanding available
families is described in <code><a href="../articles/customising.html">vignette("customising")</a></code>.</p>
<p>Due to the implementation using a <code>family</code> object, This
also means that any compatible link function can be used for a family,
like fx. logit or probit for the binomial family. Also, the unexported
<code>check_family</code> function in the package ensures that accepted
values for the <code>family</code> argument in all the package’s
functions are a <code>character</code>, <code>family</code> function or
a <code>family</code> class object. The different uses will be seen
throughout the examples in this vignette but is also available in the
example section of the <code><a href="../reference/mcmcglm.html">mcmcglm()</a></code> documentation.</p>
<div class="section level4">
<h4 id="data-simulation-for-examples">Data simulation for examples<a class="anchor" aria-label="anchor" href="#data-simulation-for-examples"></a>
</h4>
<p>In order to show that the package provides samples from the target
posterior distribution, we simulate data for each scenario with known
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
vector in order to see if the empirical distribution of each coefficient
seems to match the value we simulated data from.</p>
<p>We start by generating a linear predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mo>=</mo><mi>X</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">\eta=X\beta</annotation></semantics></math>
from known values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
and sampled values making up the design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
Then, in each example we can apply the relevant inverse link function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">g^{-1}</annotation></semantics></math>
to obtain the modelled mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu=g^{-1}(X\beta)</annotation></semantics></math>
in the GLM model. We can the simulate our response as sampling from the
distribution corresponding to the family using the modelled mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
as the relevant parameter of the distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span> <span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span> <span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">lin_pred</span> <span class="op">&lt;-</span> <span class="va">b0</span><span class="op">+</span><span class="va">b1</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="va">b2</span><span class="op">*</span><span class="va">x2</span></span></code></pre></div>
<p>An example for the gaussian family is available in the introductory
example in the <a href="https://mathiaslj.github.io/mcmcglm/index.html">README</a>.</p>
</div>
<div class="section level3">
<h3 id="example-for-binomial-family">Example for binomial family<a class="anchor" aria-label="anchor" href="#example-for-binomial-family"></a>
</h3>
<p>For the binomial family, the most commonly used link function is the
logit given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>ln</mo><mfrac><mi>p</mi><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
logit(p)=\ln\frac{p}{1-p}
\end{align}</annotation></semantics></math></p>
<p>but other link functions are also available, including probit,
cauchit, log and cloglog (see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">help(family)</a></code> for more
information).</p>
<p>We’ll show an example first for the binomial family with logit link
function.</p>
<div class="section level4">
<h4 id="logit-link-function">Logit link function<a class="anchor" aria-label="anchor" href="#logit-link-function"></a>
</h4>
<p>First, we define the data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logit_binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mu_logit</span> <span class="op">&lt;-</span> <span class="va">logit_binom</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span><span class="va">y_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">mu_logit</span><span class="op">)</span></span>
<span><span class="va">dat_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_logit</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
<p>Then we fit the <code>mcmcglm</code> and inspect the trace plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">dat_logit</span>,</span>
<span>                  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>                  beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">logit</span></span>
<span><span class="co">#&gt; Object of class 'mcmcglm'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  mcmcglm(formula = Y ~ ., family = binomial(link = "logit"), data = dat_logit, </span></span>
<span><span class="co">#&gt;     beta_prior = distributional::dist_normal(mean = 0, sd = 1), </span></span>
<span><span class="co">#&gt;     w = 0.5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average of parameter samples:</span></span>
<span><span class="co">#&gt;   (Intercept)       X1       X2</span></span>
<span><span class="co">#&gt; 1   0.8802159 1.461209 2.061524</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/logit-run-show-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="probit-link-function">Probit link function<a class="anchor" aria-label="anchor" href="#probit-link-function"></a>
</h4>
<p>First, we define the data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probit_binom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mu_probit</span> <span class="op">&lt;-</span> <span class="va">probit_binom</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span><span class="va">y_probit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">mu_probit</span><span class="op">)</span></span>
<span><span class="va">dat_probit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_probit</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
<p>Then we fit the <code>mcmcglm</code> and inspect the trace plot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">dat_probit</span>,</span>
<span>                  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>                  beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">probit</span></span>
<span><span class="co">#&gt; Object of class 'mcmcglm'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  mcmcglm(formula = Y ~ ., family = binomial(link = "probit"), </span></span>
<span><span class="co">#&gt;     data = dat_probit, beta_prior = distributional::dist_normal(mean = 0, </span></span>
<span><span class="co">#&gt;         sd = 1), w = 0.5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average of parameter samples:</span></span>
<span><span class="co">#&gt;   (Intercept)       X1       X2</span></span>
<span><span class="co">#&gt; 1   0.8318177 1.374661 2.162339</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">probit</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/probit-run-show-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="example-for-poisson-family">Example for poisson family<a class="anchor" aria-label="anchor" href="#example-for-poisson-family"></a>
</h3>
<p>For the poisson family, the most commonly used link function is log,
which is the only one we will showcase as the above example for the
binomial family shows how it’s easily possible to specify the link
function.</p>
<p>Define the data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span><span class="va">y_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, lambda <span class="op">=</span> <span class="va">mu_log</span><span class="op">)</span></span>
<span><span class="va">dat_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_pois</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
<p>Then we fit the <code>mcmcglm</code> and inspect the trace plot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                data <span class="op">=</span> <span class="va">dat_pois</span>,</span>
<span>                family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>                beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">pois</span></span>
<span><span class="co">#&gt; Object of class 'mcmcglm'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  mcmcglm(formula = Y ~ ., family = "poisson", data = dat_pois, </span></span>
<span><span class="co">#&gt;     beta_prior = distributional::dist_normal(mean = 0, sd = 1), </span></span>
<span><span class="co">#&gt;     w = 0.5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average of parameter samples:</span></span>
<span><span class="co">#&gt;   (Intercept)       X1       X2</span></span>
<span><span class="co">#&gt; 1   0.9969416 1.504678 1.997051</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">pois</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/poisson-run-show-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="example-for-negative-binomial-family">Example for negative binomial family<a class="anchor" aria-label="anchor" href="#example-for-negative-binomial-family"></a>
</h3>
<p>Besides the families available in the stats package (via
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">help("family")</a></code>), other families have been implemented in
various packages. Fx. the <code><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">MASS::negative.binomial()</a></code>
function which allows the use of the negative binomial family in various
inference procedures.</p>
<p>This distribution is an interesting choice for modelling of count
data when a Poisson distribution is not appropriate due to the equality
of the first and second moment of the distribution.</p>
<p>Below we showcase the use of this family using this package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lin_pred</span><span class="op">)</span></span>
<span><span class="va">y_nbinom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="va">mu_log</span><span class="op">)</span></span>
<span><span class="va">dat_nbinom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_nbinom</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
<p>Then we fit the <code>mcmcglm</code> and inspect the trace plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nbinom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">dat_nbinom</span>,</span>
<span>                  family <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html" class="external-link">negative.binomial</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>                  beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">nbinom</span></span>
<span><span class="co">#&gt; Object of class 'mcmcglm'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  mcmcglm(formula = Y ~ ., family = MASS::negative.binomial(theta), </span></span>
<span><span class="co">#&gt;     data = dat_nbinom, beta_prior = distributional::dist_normal(mean = 0, </span></span>
<span><span class="co">#&gt;         sd = 1), w = 0.5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average of parameter samples:</span></span>
<span><span class="co">#&gt;   (Intercept)       X1       X2</span></span>
<span><span class="co">#&gt; 1   0.9608508 1.431976 2.059662</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">nbinom</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/negbin-run-show-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-the-prior-distribution">Specifying the prior distribution<a class="anchor" aria-label="anchor" href="#specifying-the-prior-distribution"></a>
</h2>
<p>The package uses the <a href="https://CRAN.R-project.org/package=distributional" class="external-link">distributional</a>
package to specify the prior distribution of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
parameter as is mentioned in the documentation in
<code><a href="../reference/mcmcglm.html">mcmcglm()</a></code>. The <a href="https://CRAN.R-project.org/package=distributional" class="external-link">distributional</a>
package provides vectorised distribution objects with specified
parameters with methods for evaluating densities, CDFs, etc. and
generate random samples from the distribution.</p>
<p>The use in this package allows the user great flexibility in
specifying varying independent univariate distributions or multivariate
distributions for the parameter vector as will be illustrated in the
examples below.</p>
<p>In all examples we will simply use a gaussian family of the response
as in the introductory example in the <a href="https://mathiaslj.github.io/mcmcglm/index.html">README</a> and
alternate prior specifications.</p>
<p>Start by defining some data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">lin_pred</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dat_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y_norm</span>, X1 <span class="op">=</span> <span class="va">x1</span>, X2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-of-iid-priors">Example of iid priors<a class="anchor" aria-label="anchor" href="#example-of-iid-priors"></a>
</h3>
<p>In the case of iid priors, a single univariate distribution
specification is needed:</p>
<blockquote>
<p>To make the example not the exact same as the introductory example in
the README, we show how the posterior distribution is affected by a
prior with a mean very different from what the data(/likelihood) is
showing.</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>               family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>               data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>               beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>               w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">iid</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/iid-run-show-1.png" width="768"></p>
<p>Of course, any distribution could be used here using the
<code>dist_</code> functions of the <a href="https://CRAN.R-project.org/package=distributional" class="external-link">distributional</a>
package. Here, we simply use a normal distribution with
<code><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">distributional::dist_normal()</a></code>, but it might as well have
been <code><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_gamma.html" class="external-link">distributional::dist_gamma()</a></code>,
<code><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_student_t.html" class="external-link">distributional::dist_student_t()</a></code>, etc. See the <a href="https://pkg.mitchelloharawild.com/distributional/reference/index.html" class="external-link">Reference</a>
for a full list of distributions.</p>
</div>
<div class="section level3">
<h3 id="example-of-independent-and-potentially-different-priors">Example of independent and potentially different priors<a class="anchor" aria-label="anchor" href="#example-of-independent-and-potentially-different-priors"></a>
</h3>
<p>Due to an S3 method implementation in this <a href="https://github.com/mathiaslj/mcmcglm" class="external-link">mcmcglm</a> package, it’s
possible to specify <code>beta_prior</code> as a list of
<code>distribution</code> objects. For illustrative purposes, we use the
distributions mentioned in the above example to specify a different
prior for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
component.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                 family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>                 beta_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_gamma.html" class="external-link">dist_gamma</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                   <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_student_t.html" class="external-link">dist_student_t</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">8</span>, mu <span class="op">=</span> <span class="fl">3</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>                 <span class="op">)</span>,</span>
<span>                 w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">indep</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/indep-run-show-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="example-of-multivariate-prior">Example of multivariate prior<a class="anchor" aria-label="anchor" href="#example-of-multivariate-prior"></a>
</h3>
<p>The only implemented multivariate distribution is the
<code><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_multivariate_normal.html" class="external-link">distributional::dist_multivariate_normal()</a></code>, which we can
use to specify different moments and potential correlation between
parameters in the model. An example is shown below with a prior
distribution specified as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>β</mi><mo>∼</mo><msub><mi>𝒩</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>3</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0.2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\beta\sim \mathcal{N}_3\left(
\begin{pmatrix}
1\\2\\3
\end{pmatrix},
\begin{bmatrix}
1 &amp; 0.5 &amp; 0.2\\
0.5 &amp; 1 &amp; 0.5\\
0.2 &amp; 0.5 &amp; 1
\end{bmatrix}
\right)
\end{align}</annotation></semantics></math></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>                beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_multivariate_normal.html" class="external-link">dist_multivariate_normal</a></span><span class="op">(</span></span>
<span>                  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                      ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                      byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="op">)</span>,</span>
<span>                w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">mult</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/mult-run-show-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="tuning-and-changing-the-slice-sampler-procedure">Tuning (and changing) the slice sampler procedure<a class="anchor" aria-label="anchor" href="#tuning-and-changing-the-slice-sampler-procedure"></a>
</h2>
<p>The sampling procedure in the package uses the <strong>compute graph
gibbs (CGGibbs)</strong> sampler as introduced in <a href="https://arxiv.org/abs/2410.03630" class="external-link">Luu et al. 2024</a>. This is
done to efficiently “update” the linear predictor after each gibbs
update of a single component of the parameter vector rather than naively
recalculating the linear predictor using all terms.</p>
<div class="section level3">
<h3 id="advantage-of-cggibbs">Advantage of CGGibbs<a class="anchor" aria-label="anchor" href="#advantage-of-cggibbs"></a>
</h3>
<p>See more details in the article, but we’ll quickly show the simple
and elegant idea here. Assuming that in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>’th
iteration (out of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
total iterations) we have sampled a new
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>’th
coordinate of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>β</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\beta_j^{(k)}</annotation></semantics></math>,
the “current” value is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>β</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>β</mi><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msubsup><mi>β</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>β</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msubsup><mi>β</mi><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\beta_{(j)}^{(k)}=\left(\beta_1^{(k)}, \beta_2^{(k)}, ..., \beta_j^{(k)}, \beta_{j+1}^{(k-1)}, ..., \beta_{d}^{(k-1)}\right)
\end{align}</annotation></semantics></math></p>
<p>The CGGibbs approach to calculate the linear predictor in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>’th
iteration for component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{(j)}^{(k)}</annotation></semantics></math>,
is then <span class="math display">$$\begin{align}
  \eta_{(j)}^{(k)}=\eta_{(j-1)}^{(k)}+\sum_{i=1}^n x_{ij}
(\beta_j^{(k)}-\beta_j^{(k-1)})}
\end{align}$$</span></p>
<p>while the naive approach is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>η</mi><mi>j</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>l</mi></mrow></msub><msubsup><mi>β</mi><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>𝟏</mn><mrow><mo stretchy="true" form="prefix">[</mo><mi>j</mi><mo>&gt;</mo><mi>l</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \eta_j^{(k)}=\sum_{i=1}^n\sum_{l=1}^d x_{il} \beta_l^{(k-\mathbf{1}[j&gt;l])}
\end{align}</annotation></semantics></math></p>
<p>This means that using CGGibbs, for any component update of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
the computation time is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math>,
compared to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(dn)</annotation></semantics></math>
for the naive approach.</p>
</div>
<div class="section level3">
<h3 id="advantages-of-slice-sampling-in-combination-with-cggibbs">Advantages of slice sampling (in combination with CGGibbs)<a class="anchor" aria-label="anchor" href="#advantages-of-slice-sampling-in-combination-with-cggibbs"></a>
</h3>
<p>The linear predictor is used to calculate the log-likelihood, which
is summed with the log-density of the prior distribution to obtain the
log-potential, being the log-posterior up to a normalising constant. The
log-potential is calculated in this algorithm in order to use slice
sampling, which enables us to use any combination of family of the
response and prior distribution of the parameters as we do not rely on
conjugacy to get closed-form distributions to sample from.</p>
<p>Further, the slice sampling avoids spending computational power on
numerical integration to find the normalising constant corresponding to
the marginal distribution of data as the sampling procedure needs only
know the posterior up to proportionality; the reason we use the
log-potential.</p>
<p>The default method of slice sampling is with “stepping-out” and
“shrinkage” as described in <a href="https://projecteuclid.org/journals/annals-of-statistics/volume-31/issue-3/Slice-sampling/10.1214/aos/1056562461.full" class="external-link">Neal
2003</a>.</p>
</div>
<div class="section level3">
<h3 id="using-the-default-slice-sampling-method">Using the default slice sampling method<a class="anchor" aria-label="anchor" href="#using-the-default-slice-sampling-method"></a>
</h3>
<p>All <code>slice_</code> functions from the <a href="https://CRAN.R-project.org/package=qslice" class="external-link">qslice</a> package have
arguments <code>x</code> and <code>log_target</code>. The
<code>mcmcglm</code> function finds these entities as a new component of
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
vector in any given iteration and as the log-potential evaluated as a
function of this new value of the parameter.</p>
<p>Thus, the task left to the user is to specify tuning parameters of
the chosen algorithm, which is passed through <code>...</code> in
<code><a href="../reference/mcmcglm.html">mcmcglm()</a></code>. The default slice sampler uses the
<code><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">qslice::slice_stepping_out()</a></code> function, which has a
mandatory non-default argument <code>w</code> with the slice width of
the algorithm. Thus, as readers might have noticed in other examples
within this vignette or the <a href="https://mathiaslj.github.io/mcmcglm/index.html">README</a>, a
specification of <code>w = x</code> is given in the calls to
<code><a href="../reference/mcmcglm.html">mcmcglm()</a></code>. Example below for completeness:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>                beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                w <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-the-default-slice-sampling-method">Changing the default slice sampling method<a class="anchor" aria-label="anchor" href="#changing-the-default-slice-sampling-method"></a>
</h3>
<p>The argument <code>qslice_fun</code> in the <code><a href="../reference/mcmcglm.html">mcmcglm()</a></code>
function allows the user to change the default slice sampler
<code><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">qslice::slice_stepping_out()</a></code> to any slice sampler from the
<code>qslice</code> package. Thus, below is an example of using
<code><a href="https://rdrr.io/pkg/qslice/man/slice_elliptical.html" class="external-link">qslice::slice_elliptical()</a></code> from <a href="https://proceedings.mlr.press/v9/murray10a" class="external-link">Murray et
al. (2010)</a>, which has tuning parameters <code>mu</code> and
<code>sigma</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">el</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>                beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_elliptical.html" class="external-link">slice_elliptical</a></span>,</span>
<span>                mu <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">el</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/slice-elliptical-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="investigating-effect-of-tuning-parameters-of-slice-sampler">Investigating effect of tuning parameters of slice sampler<a class="anchor" aria-label="anchor" href="#investigating-effect-of-tuning-parameters-of-slice-sampler"></a>
</h3>
<p>The utility functions <code><a href="../reference/mcmcglm_across_tuningparams.html">mcmcglm_across_tuningparams()</a></code> and
<code><a href="../reference/plot_mcmcglm_across_tuningparams.html">plot_mcmcglm_across_tuningparams()</a></code> can be used to create
trace plots of the samples from running the algorithm with different
values of tuning parameters.</p>
<div class="section level4">
<h4 id="varying-slice-width-for-the-default-slice-sampler">Varying slice width for the default slice sampler<a class="anchor" aria-label="anchor" href="#varying-slice-width-for-the-default-slice-sampler"></a>
</h4>
<p>Fx. for the default choice of slice sampler,
<code><a href="https://rdrr.io/pkg/qslice/man/slice_stepping_out.html" class="external-link">qslice::slice_stepping_out()</a></code>, the tuning parameter is the
slice width <code>w</code>. A way to create a plot of samples across
different values of the slice width is seen below:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w05_mcmcglms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm_across_tuningparams.html">mcmcglm_across_tuningparams</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.5</span>, by <span class="op">=</span> <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  tuning_parameter_name <span class="op">=</span> <span class="st">"w"</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_norm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_mcmcglm_across_tuningparams.html">plot_mcmcglm_across_tuningparams</a></span><span class="op">(</span><span class="va">w05_mcmcglms</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/vary-w-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="varying-degrees-of-freedom-in-a-generalized-elliptical-slice-sampler">Varying degrees of freedom in a generalized elliptical slice
sampler<a class="anchor" aria-label="anchor" href="#varying-degrees-of-freedom-in-a-generalized-elliptical-slice-sampler"></a>
</h4>
<p>Since the utility function work generally for any single tuning
parameter, below is an example of <code><a href="https://rdrr.io/pkg/qslice/man/slice_elliptical.html" class="external-link">qslice::slice_elliptical</a></code>
sampling procedure described in <a href="https://jmlr.org/papers/v15/nishihara14a.html" class="external-link">Nishihara et
al. (2014)</a>, varying the <code>df</code> parameter in the
algorithm.</p>
<blockquote>
<p>Note that only a single tuning parameter can be “varied” at a time.
So in the below example, we have to keep <code>sigma</code> and
<code>mu</code> constant, while we vary over <code>df</code></p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1_mcmcglms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm_across_tuningparams.html">mcmcglm_across_tuningparams</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tuning_parameter_name <span class="op">=</span> <span class="st">"df"</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>  qslice_fun <span class="op">=</span> <span class="fu">qslice</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/qslice/man/slice_genelliptical.html" class="external-link">slice_genelliptical</a></span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_mcmcglm_across_tuningparams.html">plot_mcmcglm_across_tuningparams</a></span><span class="op">(</span><span class="va">df1_mcmcglms</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/vary-df-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="normal-normal-sample-method">Normal-normal sample method<a class="anchor" aria-label="anchor" href="#normal-normal-sample-method"></a>
</h3>
<p>Mostly for testing purposes, the package has an implementation of
sampling from a closed-form normal distribution in the case where both
the response and prior are normally distributed. Running this requires
specifying <code>"normal-normal"</code> in the argument
<code>sample_method</code> in <code><a href="../reference/mcmcglm.html">mcmcglm()</a></code> as seen in the
example below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcglm.html">mcmcglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">dat_norm</span>,</span>
<span>                beta_prior <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                sample_method <span class="op">=</span> <span class="st">"normal-normal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/trace_plot.html">trace_plot</a></span><span class="op">(</span><span class="va">norm_norm</span><span class="op">)</span></span></code></pre></div>
<p><img src="pospkg_files/figure-html/normal-normal-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mathias Lerbech Jeppesen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
